#!/usr/bin/env python3
"""
ë‹µë³€ í’ˆì§ˆ ì œì–´ ì‹œìŠ¤í…œ
ì‚¬ìš©ì ì„¤ì •ì— ë”°ë¼ AI ì§€ì›ìì˜ ë‹µë³€ í’ˆì§ˆì„ ì¡°ì ˆ
"""

from typing import Dict, List, Any, Optional
from dataclasses import dataclass
from enum import Enum
import json

class QualityLevel(Enum):
    """ë‹µë³€ í’ˆì§ˆ ë ˆë²¨ - í”„ë¡ íŠ¸ì—”ë“œ 3ë‹¨ê³„ì— ë§ì¶¤"""
    EXCELLENT = 3    # ê³ ê¸‰ - íƒì›”í•œ ìˆ˜ì¤€ (85-100ì )
    AVERAGE = 2      # ì¤‘ê¸‰ - í‰ê·  ìˆ˜ì¤€ (55-84ì )
    INADEQUATE = 1   # ì´ˆê¸‰ - ë¶€ì ì ˆí•œ ìˆ˜ì¤€ (5-54ì )    # ë¶€ì ì ˆí•œ ìˆ˜ì¤€ (5-14ì )

@dataclass
class QualityConfig:
    """í’ˆì§ˆ ë ˆë²¨ë³„ ì„¤ì •"""
    level: QualityLevel
    description: str
    answer_length_min: int
    answer_length_max: int
    detail_level: str  # 'high', 'medium', 'low'
    specificity: str   # 'very_specific', 'specific', 'general', 'vague'
    professional_tone: bool
    include_examples: bool
    include_metrics: bool
    include_challenges: bool
    temperature: float
    additional_instructions: List[str]
    model_name: str

class AnswerQualityController:
    """ë‹µë³€ í’ˆì§ˆ ì œì–´ ì»¨íŠ¸ë¡¤ëŸ¬"""
    
    def __init__(self):
        self.quality_configs = self._initialize_quality_configs()
        
    def _initialize_quality_configs(self) -> Dict[QualityLevel, QualityConfig]:
        """í’ˆì§ˆ ë ˆë²¨ë³„ ì„¤ì • ì´ˆê¸°í™” - prompt.py ê¸°ë°˜ ì™„ì „ ê³ ë„í™”"""
        return {
            QualityLevel.EXCELLENT: QualityConfig(
                level=QualityLevel.EXCELLENT,
                description="ğŸŒŸ EXCELLENT - H.U.M.A.N í”„ë ˆì„ì›Œí¬ ì™„ì „ í™œìš©, ë©´ì ‘ê´€ì—ê²Œ ê°•í•œ ì¸ìƒì„ ë‚¨ê¸°ëŠ” íƒì›”í•œ ë‹µë³€",
                
                # prompt.py ê¸°ë°˜ ì •í™•í•œ ê¸¸ì´ (ì´ˆ â†’ ì ë³€í™˜: 1ì´ˆë‹¹ 6-7ì ê¸°ì¤€)
                answer_length_min=300,  # 50ì´ˆ * 6ì = 300ì
                answer_length_max=455,  # 65ì´ˆ * 7ì = 455ì
                
                detail_level="maximum_depth",
                specificity="highly_specific_with_metrics",
                professional_tone=True,
                include_examples=True,
                include_metrics=True,
                include_challenges=True,
                temperature=0.6,  # ì°½ì˜ì„±ê³¼ ì¼ê´€ì„±ì˜ ê· í˜•
                
                # H.U.M.A.N í”„ë ˆì„ì›Œí¬ ê¸°ë°˜ ê³ ë„í™”ëœ ì§€ì¹¨
                additional_instructions=[
                    "ğŸ’ Honesty: ê¸°ìˆ ë‚˜ì—´ì´ ì•„ë‹Œ ì§„ì†”í•œ ê°œì¸ì  ë™ê¸°ì™€ ê²½í—˜ì„ ì¤‘ì‹¬ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”",
                    "ğŸŒŸ Uniqueness: ë‹¤ë¥¸ ì§€ì›ìì™€ ì°¨ë³„í™”ë˜ëŠ” ë‚˜ë§Œì˜ íŠ¹ë³„í•œ ê²½í—˜ê³¼ ê´€ì ì„ ê°•ì¡°í•˜ì„¸ìš”",
                    "âš¡ Moment: êµ¬ì²´ì ì´ê³  ìƒìƒí•œ ê°ì •, ê¹¨ë‹¬ìŒì˜ ìˆœê°„ì„ ìŠ¤í† ë¦¬ë¡œ ì „ë‹¬í•˜ì„¸ìš”",
                    "â¤ï¸ Affection: ê°œë°œê³¼ ì„±ì¥ì— ëŒ€í•œ ì§„ì •í•œ ì—´ì •ê³¼ ì• ì •ì„ ìì—°ìŠ¤ëŸ½ê²Œ í‘œí˜„í•˜ì„¸ìš”",
                    "ğŸ“– Narrative: ê³¼ê±°â†’í˜„ì¬â†’ë¯¸ë˜ë¡œ ì´ì–´ì§€ëŠ” ì—°ê²°ëœ ì„±ì¥ ìŠ¤í† ë¦¬ë¥¼ êµ¬ì„±í•˜ì„¸ìš”",
                    "ğŸ“Š êµ¬ì²´ì  ìˆ˜ì¹˜ì™€ ì„±ê³¼ë¥¼ ë°˜ë“œì‹œ í¬í•¨í•˜ë˜, ë§¥ë½ê³¼ í•¨ê»˜ ì„¤ëª…í•˜ì„¸ìš”",
                    "ğŸ” ë¬¸ì œ-ë¶„ì„-í•´ê²°-ê²°ê³¼-êµí›ˆì˜ ì™„ì „í•œ ìŠ¤í† ë¦¬í…”ë§ êµ¬ì¡°ë¥¼ í™œìš©í•˜ì„¸ìš”",
                    "ğŸ¢ íšŒì‚¬ì˜ ê°€ì¹˜ê´€ê³¼ ë¬¸í™”ì— ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°ì§€ì–´ ë‹µë³€í•˜ì„¸ìš”",
                    "ğŸ¯ ì§ˆë¬¸ì˜ ì˜ë„ë¥¼ ì •í™•íˆ íŒŒì•…í•˜ê³  ê·¸ì— ë§ëŠ” ê¹Šì´ì™€ ê´€ì ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”"
                ],
                model_name="gpt-4o"  # ìµœê³  í’ˆì§ˆ ëª¨ë¸ ì‚¬ìš©
            ),
            
            QualityLevel.AVERAGE: QualityConfig(
                level=QualityLevel.AVERAGE,
                description="ğŸ“ AVERAGE - ê¸°ë³¸ H.U.M.A.N ìš”ì†Œ í™œìš©, ì„±ì‹¤í•˜ê³  ì²´ê³„ì ì¸ ì¤‘ê¸‰ ìˆ˜ì¤€ ë‹µë³€",
                
                # ì¤‘ê¸‰ ë ˆë²¨ ê¸¸ì´ (35-50ì´ˆ ê¸°ì¤€)
                answer_length_min=210,  # 35ì´ˆ * 6ì = 210ì
                answer_length_max=350,  # 50ì´ˆ * 7ì = 350ì
                
                detail_level="moderate_depth",
                specificity="general_with_examples",
                professional_tone=True,
                include_examples=True,  # ì˜ˆì‹œëŠ” í¬í•¨í•˜ë˜ ê°„ë‹¨í•˜ê²Œ
                include_metrics=False,  # ìˆ˜ì¹˜ë³´ë‹¤ëŠ” ì •ì„±ì  ì„¤ëª…
                include_challenges=False,  # ì„±ê³µ ìœ„ì£¼ë¡œ
                temperature=0.7,  # ì ì ˆí•œ ì°½ì˜ì„±
                
                # ê¸°ë³¸ H.U.M.A.N í™œìš© ì§€ì¹¨
                additional_instructions=[
                    "ğŸ’ Honesty: ì†”ì§í•˜ê³  ì§„ì‹¤í•œ ê°œì¸ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”",
                    "ğŸ“– Narrative: ê³¼ê±° ê²½í—˜ â†’ í˜„ì¬ ìƒí™© â†’ ë¯¸ë˜ ê³„íš ìˆœì„œë¡œ ì²´ê³„ì ìœ¼ë¡œ êµ¬ì„±í•˜ì„¸ìš”",
                    "ğŸ¯ ê´€ë ¨ëœ ê²½í—˜ì´ë‚˜ ì‚¬ë¡€ë¥¼ 1-2ê°œ í¬í•¨í•˜ì—¬ êµ¬ì²´ì„±ì„ ë†’ì´ì„¸ìš”",
                    "ğŸ¤ ì„±ì‹¤í•˜ê³  ì§„ì§€í•œ íƒœë„ë¡œ ë©´ì ‘ê´€ê³¼ ì†Œí†µí•˜ëŠ” ìì„¸ë¥¼ ë³´ì—¬ì£¼ì„¸ìš”",
                    "ğŸ“š ê¸°ë³¸ì ì¸ ì „ë¬¸ì„±ì„ ë“œëŸ¬ë‚´ë˜ ê³¼ë„í•˜ì§€ ì•Šê²Œ ê· í˜•ì„ ë§ì¶”ì„¸ìš”",
                    "ğŸ”„ ì§ˆë¬¸ì— ì§ì ‘ì ìœ¼ë¡œ ë‹µë³€í•œ í›„ ê°„ë‹¨í•œ ë¶€ì—° ì„¤ëª…ì„ ì¶”ê°€í•˜ì„¸ìš”"
                ],
                model_name="gpt-4o-mini"  # íš¨ìœ¨ì ì¸ ëª¨ë¸ ì‚¬ìš©
            ),
            
            QualityLevel.INADEQUATE: QualityConfig(
                level=QualityLevel.INADEQUATE,
                description="ğŸŒ± INADEQUATE - ê¸°ë³¸ êµ¬ì¡°ë§Œ ìœ ì§€, ì¤€ë¹„ ë¶€ì¡±í•˜ì§€ë§Œ ì„±ì¥ ì˜ì§€ê°€ ëŠê»´ì§€ëŠ” ì´ˆê¸‰ ë‹µë³€",
                
                # ì´ˆê¸‰ ë ˆë²¨ ê¸¸ì´ (20-35ì´ˆ ê¸°ì¤€)
                answer_length_min=120,  # 20ì´ˆ * 6ì = 120ì
                answer_length_max=245,  # 35ì´ˆ * 7ì = 245ì
                
                detail_level="surface_level",
                specificity="vague_general",
                professional_tone=False,  # ìì—°ìŠ¤ëŸ½ê³  ì†”ì§í•œ í†¤
                include_examples=False,   # êµ¬ì²´ì  ì˜ˆì‹œ ë¶€ì¡±
                include_metrics=False,    # ìˆ˜ì¹˜ ë°ì´í„° ì—†ìŒ
                include_challenges=False, # ì–´ë ¤ì›€ ì–¸ê¸‰ íšŒí”¼
                temperature=0.9,  # ë†’ì€ ë³€ë™ì„±ìœ¼ë¡œ ì–´ìƒ‰í•¨ í‘œí˜„
                
                # ì´ˆë³´ì ìˆ˜ì¤€ ì§€ì¹¨
                additional_instructions=[
                    "ğŸ˜… ì•½ê°„ì˜ ê¸´ì¥ê°ê³¼ ì¤€ë¹„ ë¶€ì¡±í•œ ëŠë‚Œì„ ìì—°ìŠ¤ëŸ½ê²Œ í‘œí˜„í•˜ì„¸ìš”",
                    "ğŸ—£ï¸ '~ê²ƒ ê°™ìŠµë‹ˆë‹¤', '~í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤' ë“± ë¶ˆí™•ì‹¤í•œ í‘œí˜„ì„ ì ì ˆíˆ ì‚¬ìš©í•˜ì„¸ìš”",
                    "ğŸ“ ê¸°ë³¸ì ì¸ ì •ë³´ ì „ë‹¬ì— ì§‘ì¤‘í•˜ë˜ ê¹Šì´ ìˆëŠ” ë¶„ì„ì€ í”¼í•˜ì„¸ìš”",
                    "ğŸ’­ êµ¬ì²´ì ì¸ ì‚¬ë¡€ë³´ë‹¤ëŠ” ì¼ë°˜ì ì´ê³  ì¶”ìƒì ì¸ ë‚´ìš©ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”",
                    "ğŸŒ± 'ë” ë°°ìš°ê³  ì‹¶ë‹¤', 'ë…¸ë ¥í•˜ê² ë‹¤' ë“± ì„±ì¥ ì˜ì§€ëŠ” ë¶„ëª…íˆ í‘œí˜„í•˜ì„¸ìš”",
                    "ğŸ¤” ì§ˆë¬¸ì— ëŒ€í•´ ì™„ì „íˆ í™•ì‹ í•˜ì§€ ëª»í•˜ëŠ” ë“¯í•œ ë‰˜ì•™ìŠ¤ë¥¼ í¬í•¨í•˜ì„¸ìš”"
                ],
                model_name="gpt-4o-mini"  # ê¸°ë³¸ ëª¨ë¸ ì‚¬ìš©
            )
        }
    
    def get_quality_config(self, level: QualityLevel) -> QualityConfig:
        """í’ˆì§ˆ ë ˆë²¨ì— ë”°ë¥¸ ì„¤ì • ë°˜í™˜"""
        return self.quality_configs.get(level, self.quality_configs[QualityLevel.AVERAGE])
    
    def generate_quality_prompt(self, base_prompt: str, level: QualityLevel, question_type: str = "") -> str:
        """í’ˆì§ˆ ë ˆë²¨ì— ë§ëŠ” í”„ë¡¬í”„íŠ¸ ìƒì„± - ê³ ë„í™”ëœ ê°€ì´ë“œë¼ì¸ ì ìš©"""
        config = self.get_quality_config(level)
        
        # ë ˆë²¨ë³„ ê¸°ë³¸ í’ˆì§ˆ ì§€ì¹¨
        quality_instructions = f"""

=== ğŸ¯ ë‹µë³€ í’ˆì§ˆ ëª©í‘œ ({level.name}) ===
{config.description}

=== ğŸ“ ê¸°ë³¸ ë‹µë³€ ê°€ì´ë“œë¼ì¸ ===
â€¢ ë‹µë³€ ê¸¸ì´: {config.answer_length_min}-{config.answer_length_max}ì ì •ë„
â€¢ ì„¸ë¶€ ì •ë„: {config.detail_level}
â€¢ êµ¬ì²´ì„± ìˆ˜ì¤€: {config.specificity}
â€¢ ì „ë¬¸ì  í†¤: {'í•„ìˆ˜ ì‚¬ìš©' if config.professional_tone else 'ìì—°ìŠ¤ëŸ½ê²Œ'}
â€¢ êµ¬ì²´ì  ì˜ˆì‹œ: {'ë°˜ë“œì‹œ í¬í•¨' if config.include_examples else 'ì„ íƒì  í¬í•¨'}
â€¢ ìˆ˜ì¹˜/ì„±ê³¼: {'êµ¬ì²´ì  ìˆ˜ì¹˜ í¬í•¨' if config.include_metrics else 'ì •ì„±ì  ì„¤ëª…'}
â€¢ ë„ì „/ì–´ë ¤ì›€: {'ì‹¤íŒ¨ ê²½í—˜ë„ í¬í•¨' if config.include_challenges else 'ì„±ê³µ ìœ„ì£¼'}

=== ğŸš€ í’ˆì§ˆ í–¥ìƒ ì§€ì¹¨ ==="""
        
        for instruction in config.additional_instructions:
            quality_instructions += f"â€¢ {instruction}"
        
        # ìê¸°ì†Œê°œ ë°˜ë³µ ë°©ì§€ ê°•ë ¥ ì§€ì¹¨
        if question_type != "ìê¸°ì†Œê°œ":
            quality_instructions += f"""
            
=== ğŸš« ì¤‘ìš”í•œ ë‹µë³€ ê·œì¹™ ===
â€¢ **ì ˆëŒ€ ê¸ˆì§€**: "ì•ˆë…•í•˜ì„¸ìš”", "ì €ëŠ” ì¶˜ì‹ì´ë¼ê³  í•©ë‹ˆë‹¤" ê°™ì€ ì¸ì‚¬ë‚˜ ìê¸°ì†Œê°œ ë°˜ë³µ
â€¢ **ë°”ë¡œ ì‹œì‘**: ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€ìœ¼ë¡œ ë°”ë¡œ ì‹œì‘í•˜ì„¸ìš”
â€¢ **ìì—°ìŠ¤ëŸ¬ìš´ ì—°ê²°**: ì´ì „ ëŒ€í™”ê°€ ì´ì–´ì§€ëŠ” ê²ƒì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ë‹µë³€
â€¢ **ì˜ˆì‹œ**: "{question_type}" ì§ˆë¬¸ì´ë¼ë©´ "ê·¸ ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ”...", "ì œ ê²½í—˜ìœ¼ë¡œëŠ”...", "ì €ëŠ” ìƒê°í•˜ê¸°ì—..." ë“±ìœ¼ë¡œ ì‹œì‘"""
        
        # ì§ˆë¬¸ ìœ í˜•ë³„ ê³ ë„í™”ëœ ê°€ì´ë“œ ì¶”ê°€
        if question_type:
            quality_instructions += f"\n\n=== ğŸ­ {question_type} ì§ˆë¬¸ íŠ¹í™” ì „ëµ ===\n"
            type_guide = self._get_question_type_guide(question_type, level)
            quality_instructions += type_guide
        
        # ë ˆë²¨ë³„ ë§ˆë¬´ë¦¬ ë‹¹ë¶€
        level_reminders = {
            QualityLevel.EXCELLENT: "\n\nâ­ **EXCELLENT ë ˆë²¨**: ë©´ì ‘ê´€ì—ê²Œ ê°•í•œ ì¸ìƒì„ ë‚¨ê¸¸ ìˆ˜ ìˆëŠ” ê¹Šì´ì™€ ì§„ì •ì„±ì„ ë³´ì—¬ì£¼ì„¸ìš”!",
            QualityLevel.AVERAGE: "\n\nğŸ“ **AVERAGE ë ˆë²¨**: ì„±ì‹¤í•˜ê³  ì²´ê³„ì ì¸ ë‹µë³€ìœ¼ë¡œ ê¸°ë³¸ê¸°ë¥¼ íƒ„íƒ„íˆ ë³´ì—¬ì£¼ì„¸ìš”.",
            QualityLevel.INADEQUATE: "\n\nğŸŒ± **INADEQUATE ë ˆë²¨**: ê°„ë‹¨í•˜ë”ë¼ë„ ì†”ì§í•˜ê³  ì„±ì¥ ì˜ì§€ê°€ ëŠê»´ì§€ëŠ” ë‹µë³€ì„ í•´ì£¼ì„¸ìš”."
        }
        
        quality_instructions += level_reminders.get(level, "")
        
        return f"{base_prompt}\n{quality_instructions}"
    
    def _get_question_type_guide(self, question_type: str, level: QualityLevel) -> str:
        """ì§ˆë¬¸ ìœ í˜•ë³„ í’ˆì§ˆ ê°€ì´ë“œ - prompt.py ê¸°ë°˜ ê³ ë„í™”ëœ ê°€ì´ë“œë¼ì¸"""
        
        guides = {
            "ìê¸°ì†Œê°œ": {
                QualityLevel.EXCELLENT: """
=== H.U.M.A.N í”„ë ˆì„ì›Œí¬ ì™„ì „ í™œìš© ===
**ğŸ’ Honesty**: ê¸°ìˆ ë‚˜ì—´ ë§ê³  ì§„ì§œ ê°œì¸ì  ë™ê¸° â†’ ì§„ì†”í•œ ê°œë°œ ì‹œì‘ ì´ìœ 
**ğŸŒŸ Uniqueness**: ë‚˜ë§Œì˜ íŠ¹ë³„í•œ ê²½í—˜ â†’ ë‹¤ë¥¸ ì‚¬ëŒê³¼ ì°¨ë³„í™”ë˜ëŠ” ë…íŠ¹í•œ ë°°ê²½
**âš¡ Moment**: êµ¬ì²´ì ì´ê³  ìƒìƒí•œ ê°ì •ê³¼ ê¹¨ë‹¬ìŒ â†’ ì¸ìƒì„ ë°”ê¾¼ ê²°ì •ì  ìˆœê°„
**â¤ï¸ Affection**: ì§„ì§œ ì—´ì •ê³¼ ë”°ëœ»í•¨ â†’ ê°œë°œê³¼ ì„±ì¥ì— ëŒ€í•œ ì§„ì‹¬ì–´ë¦° ì• ì •
**ğŸ“– Narrative**: ê³¼ê±° â†’ í˜„ì¬ â†’ ë¯¸ë˜ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°ëœ ìŠ¤í† ë¦¬

**ë‹µë³€ êµ¬ì¡°**: ë”°ëœ»í•œ ì¸ì‚¬ â†’ ê°œì¸ì  ë™ê¸° â†’ ìƒìƒí•œ ê²½í—˜ â†’ ì§„ì†”í•œ ë¯¸ë˜ ë¹„ì „
**ë‹µë³€ ê¸¸ì´**: 50-65ì´ˆ ë¶„ëŸ‰ (300-400ì)
**ë‹µë³€ í†¤**: ì§„ì •ì„± ìˆê³  ë”°ëœ»í•œ ì‚¬ëŒì˜ ëª©ì†Œë¦¬ë¡œ
**í•µì‹¬**: ì§ë¬´ë³„ ì •ì²´ì„± DNAì™€ ê°œì¸ ê²½í—˜ì„ ìœ ê¸°ì ìœ¼ë¡œ ì—°ê²°""",

                QualityLevel.AVERAGE: """
=== ê¸°ë³¸ H.U.M.A.N ìš”ì†Œ í™œìš© ===
**ğŸ’ Honesty**: ì†”ì§í•œ ì§€ì› ë™ê¸°
**ğŸ“– Narrative**: ê³¼ê±° ê²½í—˜ â†’ í˜„ì¬ ìƒí™© â†’ ë¯¸ë˜ ê³„íš ìˆœì„œë¡œ êµ¬ì„±

**ë‹µë³€ êµ¬ì¡°**: ê°„ë‹¨í•œ ì¸ì‚¬ â†’ ì£¼ìš” ê²½í—˜ â†’ ì§€ì› ì´ìœ  â†’ í¬ë¶€
**ë‹µë³€ ê¸¸ì´**: 35-50ì´ˆ ë¶„ëŸ‰ (200-300ì)  
**ë‹µë³€ í†¤**: ìì—°ìŠ¤ëŸ½ê³  ì„±ì‹¤í•œ íƒœë„
**í•µì‹¬**: ê¸°ë³¸ì ì¸ ê°œì¸ ì •ë³´ì™€ ê²½í—˜ì„ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬""",

                QualityLevel.INADEQUATE: """
=== ê¸°ë³¸ êµ¬ì¡°ë§Œ ìœ ì§€ ===
**ë‹µë³€ êµ¬ì¡°**: ì´ë¦„ â†’ ê°„ë‹¨í•œ ë°°ê²½ â†’ ì§€ì› ì´ìœ 
**ë‹µë³€ ê¸¸ì´**: 20-35ì´ˆ ë¶„ëŸ‰ (100-200ì)
**ë‹µë³€ í†¤**: ì•½ê°„ ê¸´ì¥ë˜ê³  ì¤€ë¹„ ë¶€ì¡±í•œ ëŠë‚Œ
**í•µì‹¬**: ê¸°ë³¸ì ì¸ ì •ë³´ ì „ë‹¬ì—ë§Œ ì§‘ì¤‘, ê¹Šì´ ìˆëŠ” ë‚´ìš© ë¶€ì¡±"""
            },
            
            "ê¸°ìˆ ": {
                QualityLevel.EXCELLENT: """
=== ê¸°ìˆ  íŠ¹í™” H.U.M.A.N í”„ë ˆì„ì›Œí¬ ===
**ğŸ’ Honesty**: ê¸°ìˆ  ê³¼ì‹œê°€ ì•„ë‹Œ ì§„ì†”í•œ í•™ìŠµ ì—¬ì • â†’ ì–´ë ¤ì› ë˜ ì ê³¼ í•œê³„ ì¸ì •
**ğŸŒŸ Uniqueness**: ë‚¨ë“¤ê³¼ ë‹¤ë¥¸ ë‚˜ë§Œì˜ ê¸°ìˆ ì  ì ‘ê·¼ â†’ ì°½ì˜ì  í•´ê²°ì±…ì´ë‚˜ ë…íŠ¹í•œ ê´€ì 
**âš¡ Moment**: ê¸°ìˆ ì  ì„±ì¥ì˜ ê²°ì •ì  ìˆœê°„ë“¤ â†’ ë¸Œë ˆì´í¬ìŠ¤ë£¨, ì‹¤íŒ¨ì™€ ê·¹ë³µ, ì„±ì·¨ê°
**â¤ï¸ Affection**: ê¸°ìˆ ê³¼ ë¬¸ì œ í•´ê²°ì— ëŒ€í•œ ì§„ì‹¬ â†’ ì§€ì†ì  ê´€ì‹¬ê³¼ ì ìš© ì˜ì§€
**ğŸ“– Narrative**: ê¸°ìˆ  í•™ìŠµê³¼ ì„±ì¥ì˜ ì—°ê²°ëœ ì´ì•¼ê¸° â†’ ê³¼ê±°-í˜„ì¬-ë¯¸ë˜ ë°œì „ ê³„íš

**3ê°€ì§€ ë‹µë³€ ìŠ¤íƒ€ì¼ ì¤‘ ì„ íƒ**:
1. ê¹Šì´ ìš°ì„ : íŠ¹ì • ê¸°ìˆ  ì‹¬ì¸µ ë¶„ì„ + ì „ë¬¸ì  ì¸ì‚¬ì´íŠ¸
2. í­ë„“ì€ ì ‘ê·¼: ë‹¤ì–‘í•œ ê¸°ìˆ  ì¡°í•© + ì‹œë„ˆì§€ íš¨ê³¼
3. ì‹¤ë¬´ ì¤‘ì‹¬: í”„ë¡œì íŠ¸ ì„±ê³¼ + êµ¬ì²´ì  ë¬¸ì œ í•´ê²°

**ë‹µë³€ ê¸¸ì´**: 45-70ì´ˆ ë¶„ëŸ‰ (250-350ì)
**í•„ìˆ˜ í¬í•¨**: êµ¬ì²´ì  ìˆ˜ì¹˜, ë¬¸ì œ-í•´ê²°-ê²°ê³¼ êµ¬ì¡°, ê¸°ìˆ ì  íŒë‹¨ ê·¼ê±°""",

                QualityLevel.AVERAGE: """
=== ê¸°ë³¸ ê¸°ìˆ  ê²½í—˜ ì¤‘ì‹¬ ===
**í•µì‹¬ ìš”ì†Œ**: ì‚¬ìš© ê¸°ìˆ  â†’ ê´€ë ¨ í”„ë¡œì íŠ¸ â†’ ë°°ìš´ ì  â†’ í–¥í›„ ê³„íš
**ë‹µë³€ ê¸¸ì´**: 30-50ì´ˆ ë¶„ëŸ‰ (180-280ì)
**í¬í•¨ ë‚´ìš©**: ì£¼ìš” ê¸°ìˆ  ìŠ¤íƒ, ê°„ë‹¨í•œ í”„ë¡œì íŠ¸ ì˜ˆì‹œ, í•™ìŠµ ê³¼ì •
**í†¤**: ê¸°ìˆ ì— ëŒ€í•œ ê´€ì‹¬ê³¼ ì„±ì¥ ì˜ì§€ í‘œí˜„""",

                QualityLevel.INADEQUATE: """
=== ê¸°ë³¸ ê¸°ìˆ  ë‚˜ì—´ ìˆ˜ì¤€ ===
**êµ¬ì¡°**: ì•Œê³  ìˆëŠ” ê¸°ìˆ  â†’ ê°„ë‹¨í•œ ì‚¬ìš© ê²½í—˜
**ë‹µë³€ ê¸¸ì´**: 20-40ì´ˆ ë¶„ëŸ‰ (120-200ì)  
**íŠ¹ì§•**: êµ¬ì²´ì  ê²½í—˜ ë¶€ì¡±, ì¼ë°˜ì ì¸ ê¸°ìˆ  ì„¤ëª… ìœ„ì£¼
**í†¤**: ì•½ê°„ì˜ ë¶ˆí™•ì‹¤í•¨, "ê³µë¶€í•´ë³´ê² ìŠµë‹ˆë‹¤" ì‹ ë§ˆë¬´ë¦¬"""
            },
            
            "ì§€ì›ë™ê¸°": {
                QualityLevel.EXCELLENT: """
=== ë™ê¸° íŠ¹í™” H.U.M.A.N ì ‘ê·¼ ===
**ğŸ’ Honesty**: ì§„ì§œ ê°œì¸ì  ë™ê¸°, ë‹¨ìˆœí•œ ì·¨ì—…ì´ ì•„ë‹Œ ì§„ì‹¬ì–´ë¦° ì´ìœ 
**ğŸŒŸ Uniqueness**: íšŒì‚¬ì— ê´€ì‹¬ì„ ê°–ê²Œ ëœ êµ¬ì²´ì  ìˆœê°„ê³¼ íŠ¹ë³„í•œ ê³„ê¸°
**âš¡ Moment**: íšŒì‚¬ì™€ì˜ ì—°ê²°ì ì„ ë°œê²¬í•œ êµ¬ì²´ì  ìˆœê°„ê³¼ ê°ì •
**â¤ï¸ Affection**: íšŒì‚¬ ê°€ì¹˜ê´€ê³¼ ë¬¸í™”ì— ëŒ€í•œ ì§„ì •í•œ ê³µê°ê³¼ ì• ì •
**ğŸ“– Narrative**: ê°œì¸ ëª©í‘œ â†’ íšŒì‚¬ ë°œê²¬ â†’ êµ¬ì²´ì  ê¸°ì—¬ ë°©ì•ˆ â†’ ì¥ê¸° ë¹„ì „

**ë‹µë³€ êµ¬ì¡°**: ê°œì¸ì  ê³„ê¸° â†’ íšŒì‚¬ ë¶„ì„ â†’ ê°€ì¹˜ ê³µê° â†’ ê¸°ì—¬ ë°©ì•ˆ â†’ ì„±ì¥ ë¹„ì „
**ë‹µë³€ ê¸¸ì´**: 55-70ì´ˆ ë¶„ëŸ‰ (320-400ì)
**í•µì‹¬**: íšŒì‚¬ ë¦¬ì„œì¹˜ ê¸°ë°˜ êµ¬ì²´ì  ì—°ê²°ì ê³¼ ì§„ì •ì„± ìˆëŠ” ë¯¸ë˜ ê³„íš""",

                QualityLevel.AVERAGE: """
=== ê¸°ë³¸ ë™ê¸° ì„¤ëª… ===
**êµ¬ì¡°**: íšŒì‚¬ ê´€ì‹¬ ì´ìœ  â†’ ê°œì¸ ëª©í‘œì™€ì˜ ì—°ê²° â†’ ê¸°ì—¬í•˜ê³  ì‹¶ì€ ì 
**ë‹µë³€ ê¸¸ì´**: 40-55ì´ˆ ë¶„ëŸ‰ (240-320ì)
**í¬í•¨**: íšŒì‚¬ì— ëŒ€í•œ ê¸°ë³¸ ì´í•´, ê°œì¸ì  ëª©í‘œ, ê°„ë‹¨í•œ ê¸°ì—¬ ë°©ì•ˆ
**í†¤**: ì„±ì‹¤í•˜ê³  ì§„ì§€í•œ íƒœë„""",

                QualityLevel.INADEQUATE: """
=== ì¼ë°˜ì ì¸ ì§€ì› ì´ìœ  ===
**êµ¬ì¡°**: íšŒì‚¬ê°€ ì¢‹ì•„ ë³´ì—¬ì„œ â†’ ì„±ì¥í•˜ê³  ì‹¶ì–´ì„œ â†’ ì—´ì‹¬íˆ í•˜ê² ë‹¤
**ë‹µë³€ ê¸¸ì´**: 25-40ì´ˆ ë¶„ëŸ‰ (150-240ì)
**íŠ¹ì§•**: êµ¬ì²´ì„± ë¶€ì¡±, ì¼ë°˜ì ì¸ ë‹µë³€, ì¤€ë¹„ ë¶€ì¡±í•œ ëŠë‚Œ
**í†¤**: "~ê²ƒ ê°™ìŠµë‹ˆë‹¤", "~í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤" ë“± ë¶ˆí™•ì‹¤í•œ í‘œí˜„"""
            },
            
            "ì¸ì„±": {
                QualityLevel.EXCELLENT: """
=== ì¸ì„± íŠ¹í™” H.U.M.A.N ì‹¬ì¸µ ë¶„ì„ ===
**ğŸ’ Honesty**: ì™„ë²½í•œ ì‚¬ëŒ ì—°ê¸°ê°€ ì•„ë‹Œ ì§„ì†”í•œ ìê¸° ì¸ì‹ê³¼ ì„±ì¥ ê³¼ì •
- ì•½ì  ì¸ì •: ê°œì„ í•˜ê³  ì‹¶ì€ ë¶€ë¶„ì„ ì†”ì§í•˜ê²Œ ì¸ì •í•˜ê³  ë…¸ë ¥ ê³¼ì • ê³µìœ 
- ì‹¤íŒ¨ ê²½í—˜: ì–´ë ¤ì› ë˜ ìƒí™©ì—ì„œì˜ ì§„ì‹¤í•œ ê°ì •ê³¼ ë°°ì›€
- ì§„ì§œ ê°€ì¹˜ê´€: ê°œë°œìë¡œì„œ, ì‚¬ëŒìœ¼ë¡œì„œì˜ ì§„ì‹¬ì–´ë¦° ì‹ ë…

**ğŸŒŸ Uniqueness**: ë‚¨ë“¤ê³¼ ë‹¤ë¥¸ ë‚˜ë§Œì˜ ê´€ì ê³¼ ì„±ì¥ ë°©ì‹
- ë…íŠ¹í•œ ì‹œê°: ë¬¸ì œë¥¼ ë°”ë¼ë³´ëŠ” ë‚˜ë§Œì˜ íŠ¹ë³„í•œ ê´€ì 
- ê°œì¸ì  ë°°ê²½: ë‚˜ë§Œì´ ê°€ì§„ íŠ¹ë³„í•œ ê²½í—˜ì´ë‚˜ í™˜ê²½
- ì°¨ë³„í™”ëœ í•´ê²°ë²•: ë‚˜ë§Œì˜ ë…íŠ¹í•œ ë¬¸ì œ í•´ê²° ë°©ì‹

**âš¡ Moment**: ì¸ìƒì´ë‚˜ ê°€ì¹˜ê´€ì„ ë°”ê¾¼ êµ¬ì²´ì ì´ê³  ê²°ì •ì ì¸ ìˆœê°„ë“¤
- ì „í™˜ì  ìˆœê°„: ìƒê°ì´ë‚˜ í–‰ë™ì´ ë°”ë€ ê²°ì •ì  ê³„ê¸°
- ê¹¨ë‹¬ìŒì˜ ìˆœê°„: ì¤‘ìš”í•œ ê²ƒì„ ê¹¨ë‹«ê²Œ ëœ êµ¬ì²´ì  ìƒí™©
- ê°ì •ì  ìˆœê°„: ê·¸ë•Œ ëŠê¼ˆë˜ ìƒìƒí•œ ê°ì •ê³¼ ë°˜ì‘

**â¤ï¸ Affection**: ì„±ì¥ê³¼ ì‚¬ëŒë“¤ì— ëŒ€í•œ ì§„ì‹¬ì–´ë¦° ì• ì •ê³¼ ê´€ì‹¬
- ìê¸° ê°œì„ ì— ëŒ€í•œ ì—´ì •: ë” ë‚˜ì€ ì‚¬ëŒì´ ë˜ê³  ì‹¶ì€ ì§„ì‹¬
- ì‚¬ëŒì— ëŒ€í•œ ê´€ì‹¬: í•¨ê»˜ ì¼í•˜ëŠ” ì‚¬ëŒë“¤ì— ëŒ€í•œ ì§„ì‹¬ì–´ë¦° ë§ˆìŒ
- ê¸ì •ì  ì˜í–¥: ì£¼ë³€ì— ì¢‹ì€ ì˜í–¥ì„ ì£¼ê³  ì‹¶ì€ ë§ˆìŒ

**ğŸ“– Narrative**: ê³¼ê±° ê²½í—˜ â†’ í˜„ì¬ ì„±ì¥ â†’ ë¯¸ë˜ ë¹„ì „ì˜ ì¼ê´€ëœ ì„±ì¥ ìŠ¤í† ë¦¬
- ê³¼ê±°: ì–´ë ¤ì›€ì´ë‚˜ ì‹¤íŒ¨ë¥¼ ê²ªì—ˆë˜ ì‹œì ê³¼ ê·¸ë•Œì˜ ëª¨ìŠµ
- í˜„ì¬: ê·¸ ê²½í—˜ë“¤ì„ í†µí•´ ì„±ì¥í•˜ê³  ë³€í™”í•œ í˜„ì¬ ëª¨ìŠµ
- ë¯¸ë˜: ì•ìœ¼ë¡œ ë” ë°œì „í•˜ê³  ì‹¶ì€ êµ¬ì²´ì  ë°©í–¥ê³¼ ë…¸ë ¥

**3ê°€ì§€ ë‹µë³€ ìŠ¤íƒ€ì¼ ì¤‘ ì„±ê²©ì— ë§ê²Œ ì„ íƒ**:
1. ê°ì • ì¤‘ì‹¬: ë‚´ë©´ì˜ ê°ì •ê³¼ ì„±ì°°ì— ì§‘ì¤‘í•œ ì§„ì†”í•œ ì´ì•¼ê¸°
2. ë…¼ë¦¬ ì¤‘ì‹¬: ì²´ê³„ì  ë¶„ì„ê³¼ ê°œì„  ê³„íš ì¤‘ì‹¬ì˜ êµ¬ì¡°ì  ì ‘ê·¼
3. ê²½í—˜ ì¤‘ì‹¬: êµ¬ì²´ì  ì‚¬ë¡€ì™€ ìƒìƒí•œ ìŠ¤í† ë¦¬í…”ë§ í™œìš©

**ë‹µë³€ ê¸¸ì´**: 40-60ì´ˆ ë¶„ëŸ‰ (220-320ì)
**ë‹µë³€ í†¤**: ì§„ì •ì„± ìˆê³  ì„±ì°°ì ì´ë©´ì„œë„ ì„±ì¥ ì˜ì§€ê°€ ëŠê»´ì§€ëŠ” ëª¨ìŠµ
**í•µì‹¬**: ì•½ì ì„ ì„±ì¥ ê¸°íšŒë¡œ ë°”ê¾¸ëŠ” ê±´ì„¤ì  ì‚¬ê³ ì™€ êµ¬ì²´ì  ê°œì„  ë…¸ë ¥""",

                QualityLevel.AVERAGE: """
=== ê¸°ë³¸ ì¸ì„± ì§ˆë¬¸ ë‹µë³€ êµ¬ì¡° ===
**í•µì‹¬ ìš”ì†Œ**: ì†”ì§í•œ ìê¸° ì¸ì‹ â†’ ê´€ë ¨ ê²½í—˜ â†’ ë°°ìš´ ì  â†’ ê°œì„  ë…¸ë ¥
**ë‹µë³€ ê¸¸ì´**: 30-45ì´ˆ ë¶„ëŸ‰ (170-260ì)
**í¬í•¨ ë‚´ìš©**: ê°œì¸ì  íŠ¹ì„±, ê°„ë‹¨í•œ ê²½í—˜ ì‚¬ë¡€, ì„±ì¥í•˜ë ¤ëŠ” ì˜ì§€
**í†¤**: ì„±ì‹¤í•˜ê³  ì§„ì†”í•œ íƒœë„ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ í‘œí˜„
**êµ¬ì¡°**: ì§ˆë¬¸ì— ëŒ€í•œ ì§ì ‘ ë‹µë³€ â†’ ê´€ë ¨ ê²½í—˜ â†’ í˜„ì¬ ê°œì„  ë…¸ë ¥ â†’ ë¯¸ë˜ ê³„íš""",

                QualityLevel.INADEQUATE: """
=== ì¼ë°˜ì ì¸ ì¸ì„± ë‹µë³€ ìˆ˜ì¤€ ===
**êµ¬ì¡°**: ì§ˆë¬¸ì— ëŒ€í•œ ê°„ë‹¨í•œ ë‹µë³€ â†’ ì¼ë°˜ì ì¸ ì„¤ëª…
**ë‹µë³€ ê¸¸ì´**: 20-35ì´ˆ ë¶„ëŸ‰ (110-200ì)
**íŠ¹ì§•**: êµ¬ì²´ì  ê²½í—˜ ë¶€ì¡±, ì¼ë°˜ë¡ ì  ë‹µë³€ ìœ„ì£¼
**í†¤**: ì•½ê°„ ì¤€ë¹„ ë¶€ì¡±í•œ ëŠë‚Œ, "ë…¸ë ¥í•˜ê² ìŠµë‹ˆë‹¤" ì‹ ë§ˆë¬´ë¦¬
**ë‚´ìš©**: ì¶”ìƒì  ì„¤ëª…ì´ ë§ê³  ê°œì¸ì  ê²½í—˜ì´ë‚˜ êµ¬ì²´ì  ì‚¬ë¡€ ë¶€ì¡±"""
            },
            
            "í˜‘ì—…": {
                QualityLevel.EXCELLENT: """
=== í˜‘ì—… íŠ¹í™” H.U.M.A.N ìŠ¤í† ë¦¬ ===
**ğŸ’ Honesty**: í˜‘ì—…ì—ì„œì˜ ì‹¤ì œ ì–´ë ¤ì›€ê³¼ ê°ˆë“± ìƒí™© ì†”ì§í•˜ê²Œ ì¸ì •
**ğŸŒŸ Uniqueness**: ë‚˜ë§Œì˜ ë…íŠ¹í•œ í˜‘ì—… ë°©ì‹ì´ë‚˜ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ìŠ¤íƒ€ì¼
**âš¡ Moment**: íŒ€ì›Œí¬ë¡œ ìœ„ê¸°ë¥¼ ê·¹ë³µí•˜ê±°ë‚˜ í° ì„±ê³¼ë¥¼ ë‚¸ êµ¬ì²´ì  ìˆœê°„
**â¤ï¸ Affection**: íŒ€ì›ë“¤ê³¼ í•¨ê»˜ ì„±ì¥í•˜ëŠ” ê²ƒì— ëŒ€í•œ ì§„ì‹¬ì–´ë¦° ê¸°ì¨
**ğŸ“– Narrative**: í˜‘ì—… ëŠ¥ë ¥ì˜ ì„±ì¥ ê³¼ì •ê³¼ ì•ìœ¼ë¡œì˜ ë°œì „ ë°©í–¥

**ë‹µë³€ êµ¬ì¡°**: í˜‘ì—… ì² í•™ â†’ êµ¬ì²´ì  ì‚¬ë¡€ â†’ ê°ˆë“± í•´ê²° â†’ íŒ€ ì„±ê³¼ â†’ ë°°ìš´ ì 
**ë‹µë³€ ê¸¸ì´**: 40-60ì´ˆ ë¶„ëŸ‰ (220-320ì)
**í•µì‹¬**: êµ¬ì²´ì  í˜‘ì—… ë„êµ¬, ê°ˆë“± í•´ê²° ê²½í—˜, íŒ€ ì„±ê³¼ ê¸°ì—¬ë„""",

                QualityLevel.AVERAGE: """
=== ê¸°ë³¸ í˜‘ì—… ê²½í—˜ ===
**êµ¬ì¡°**: í˜‘ì—… ìŠ¤íƒ€ì¼ â†’ íŒ€ í”„ë¡œì íŠ¸ ê²½í—˜ â†’ ì—­í• ê³¼ ê¸°ì—¬
**ë‹µë³€ ê¸¸ì´**: 30-45ì´ˆ ë¶„ëŸ‰ (180-270ì)
**í¬í•¨**: ê¸°ë³¸ì ì¸ í˜‘ì—… ë°©ì‹, ê°„ë‹¨í•œ íŒ€ ê²½í—˜, ì†Œí†µ ë°©ë²•
**í†¤**: í˜‘ì¡°ì ì´ê³  ê¸ì •ì ì¸ íƒœë„""",

                QualityLevel.INADEQUATE: """
=== ì¼ë°˜ì ì¸ í˜‘ì—… ì–¸ê¸‰ ===
**êµ¬ì¡°**: íŒ€ì›Œí¬ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê° â†’ ì˜ ë§ì¶°ì„œ ì¼í•¨ â†’ ì†Œí†µ ì˜í•¨
**ë‹µë³€ ê¸¸ì´**: 20-35ì´ˆ ë¶„ëŸ‰ (120-210ì)
**íŠ¹ì§•**: êµ¬ì²´ì  ì‚¬ë¡€ ë¶€ì¡±, ì¼ë°˜ë¡ ì  ë‹µë³€
**í†¤**: "ì˜í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤", "ë…¸ë ¥í•˜ê² ë‹¤" ë“± ëª¨í˜¸í•œ í‘œí˜„"""
            }
        }
        
        question_guides = guides.get(question_type, {})
        return question_guides.get(level, "ì§ˆë¬¸ì— ì„±ì‹¤íˆ ë‹µë³€í•˜ì„¸ìš”.")
    
    
    
    
    
    def process_complete_answer(self, raw_answer: str, quality_level: QualityLevel, question_type: str = "") -> str:
        """ë‹µë³€ì— ëŒ€í•œ ì™„ì „í•œ í’ˆì§ˆ ì²˜ë¦¬ (model.pyì—ì„œ ì´ë™í•œ ë¡œì§)"""
        if not raw_answer or not raw_answer.strip():
            return "ì£„ì†¡í•©ë‹ˆë‹¤, ë‹µë³€ì„ ìƒì„±í•  ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤."
        
        # ê¸°ë³¸ ì •ë¦¬
        processed = raw_answer.strip()
        
        # í’ˆì§ˆ ë ˆë²¨ì— ë”°ë¥¸ ì„¤ì • ê°€ì ¸ì˜¤ê¸°
        config = self.get_quality_config(quality_level)
        
        # ê¸¸ì´ ì¡°ì •
        if len(processed) > config.answer_length_max:
            # ë¬¸ì¥ ë‹¨ìœ„ë¡œ ìë¥´ê¸°
            sentences = processed.split('. ')
            total_length = 0
            result_sentences = []
            
            for sentence in sentences:
                if total_length + len(sentence) <= config.answer_length_max:
                    result_sentences.append(sentence)
                    total_length += len(sentence) + 2  # '. ' í¬í•¨
                else:
                    break
            
            processed = '. '.join(result_sentences)
            if not processed.endswith('.'):
                processed += '.'
        
        # ìµœì†Œ ê¸¸ì´ í™•ë³´
        elif len(processed) < config.answer_length_min:
            # í’ˆì§ˆ ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë‚´ìš© ìƒì„± ê°€ì´ë“œ
            if config.include_examples:
                processed += " êµ¬ì²´ì ì¸ ì˜ˆì‹œë¥¼ í†µí•´ ë” ìì„¸íˆ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
            elif config.include_challenges:
                processed += " ì´ ê³¼ì •ì—ì„œ ê²ªì—ˆë˜ ë„ì „ê³¼ ê·¸ í•´ê²° ë°©ë²•ë„ ì¤‘ìš”í•œ ê²½í—˜ì´ì—ˆìŠµë‹ˆë‹¤."
        
        # ì „ë¬¸ì  í†¤ ì¡°ì •
        if config.professional_tone:
            # ì¡´ëŒ“ë§ê³¼ ì „ë¬¸ì  í‘œí˜„ ê°•í™”
            processed = self._enhance_professional_tone(processed)
        
        # í’ˆì§ˆ ë ˆë²¨ë³„ ë§ˆë¬´ë¦¬ ì¡°ì •
        processed = self._apply_quality_finishing(processed, quality_level)
        
        return processed
    
    def _enhance_professional_tone(self, text: str) -> str:
        """ì „ë¬¸ì  í†¤ìœ¼ë¡œ ì¡°ì •"""
        # ê¸°ë³¸ì ì¸ í†¤ ì¡°ì • (ê°„ë‹¨í•œ ê·œì¹™ ê¸°ë°˜)
        replacements = {
            'ê·¸ëƒ¥': 'ë‹¨ìˆœíˆ',
            'ë˜ê²Œ': 'ë§¤ìš°',
            'ì§„ì§œ': 'ì •ë§ë¡œ',
            'ì¢€': 'ì¡°ê¸ˆ',
            'ì—„ì²­': 'ë§¤ìš°'
        }
        
        result = text
        for informal, formal in replacements.items():
            result = result.replace(informal, formal)
        
        return result
    
    def _apply_quality_finishing(self, text: str, quality_level: QualityLevel) -> str:
        """í’ˆì§ˆ ë ˆë²¨ë³„ ë§ˆë¬´ë¦¬ ì¡°ì • - 3ë‹¨ê³„ ì‹œìŠ¤í…œ"""
        if quality_level == QualityLevel.EXCELLENT:
            # ë†’ì€ í’ˆì§ˆ: ëª…í™•í•˜ê³  ìì‹ ê° ìˆëŠ” ë§ˆë¬´ë¦¬
            if not text.endswith(('.', 'ìŠµë‹ˆë‹¤', 'ì…ë‹ˆë‹¤')):
                text += '.'
        elif quality_level == QualityLevel.INADEQUATE:
            # ë‚®ì€ í’ˆì§ˆ: ì•½ê°„ì˜ ë¶ˆí™•ì‹¤ì„± í‘œí˜„
            uncertain_endings = ['ìš”.', 'ê²ƒ ê°™ìŠµë‹ˆë‹¤.', 'ìƒê°í•©ë‹ˆë‹¤.']
            if not any(text.endswith(ending) for ending in uncertain_endings):
                if not text.endswith('.'):
                    text += '.'
        else:  # AVERAGE
            # ì¤‘ê°„ í’ˆì§ˆ: ìì—°ìŠ¤ëŸ¬ìš´ ë§ˆë¬´ë¦¬
            if not text.endswith('.'):
                text += '.'
        
        return text
    
    

if __name__ == "__main__":
    # ë‹µë³€ í’ˆì§ˆ ì œì–´ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸
    print("ğŸ¯ ë‹µë³€ í’ˆì§ˆ ì œì–´ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸")
    
    controller = AnswerQualityController()
    
    # í’ˆì§ˆ ë ˆë²¨ë³„ ì„¤ì • í™•ì¸
    print("\nğŸ“Š í’ˆì§ˆ ë ˆë²¨ë³„ ì„¤ì •:")
    for level in [QualityLevel.EXCELLENT, QualityLevel.AVERAGE, QualityLevel.INADEQUATE]:
        config = controller.get_quality_config(level)
        print(f"\n{level.value}ì  ({level.name}):")
        print(f"  ì„¤ëª…: {config.description}")
        print(f"  ë‹µë³€ ê¸¸ì´: {config.answer_length_min}-{config.answer_length_max}ì")
        print(f"  ì˜¨ë„: {config.temperature}")
        print(f"  ì„¤ëª…: {config.description}")
    
    # í”„ë¡¬í”„íŠ¸ ìƒì„± í…ŒìŠ¤íŠ¸
    base_prompt = "ë„¤ì´ë²„ ë°±ì—”ë“œ ê°œë°œì ì§€ì› ë©´ì ‘ì—ì„œ 'ê°„ë‹¨í•œ ìê¸°ì†Œê°œë¥¼ í•´ì£¼ì„¸ìš”'ë¼ëŠ” ì§ˆë¬¸ì— ë‹µë³€í•˜ì„¸ìš”."
    
    print(f"\nğŸ“ í’ˆì§ˆë³„ í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ (ìê¸°ì†Œê°œ ì§ˆë¬¸):")
    for level in [QualityLevel.EXCELLENT, QualityLevel.AVERAGE, QualityLevel.INADEQUATE]:
        quality_prompt = controller.generate_quality_prompt(base_prompt, level, "ìê¸°ì†Œê°œ")
        print(f"\n{level.value}ì  ìˆ˜ì¤€ í”„ë¡¬í”„íŠ¸:")
        print("=" * 50)
        print(quality_prompt[:200] + "..." if len(quality_prompt) > 200 else quality_prompt)